//
//  UInt8+extensions.swift
//  packetCapture1
//
//  Created by Darrell Root on 1/24/20.
//  Copyright Â© 2020 com.darrellroot. All rights reserved.
//

import Foundation

extension Array where Element == UInt8 {
    public var hexdump: String {
        var output: String = ""
        output.reserveCapacity(self.count * 3)
        for (position,datum) in self.enumerated() {
            switch (position % 2 == 0, position % 16 == 0, position % 16 == 15) {
            case (false, false, false): // odd positions
                output.append(datum.hex)
                output.append(" ")
            case (false, false, true): // end of line, odd
                output.append(datum.hex)
                output.append("\n")
            case (true, true, false):  // beginning of line, even
                output.append(String(format: "0x%04x ",position))
                output.append(datum.hex)
            case (true, false, false): // even but not beginning of line
                output.append(datum.hex)
            case (false, true, false),(false, true, true),(true, false, true),(true, true, true):  // invalid cases
                SnmpError.log("unexpected hexdump case")
            }
        }
        if self.count % 16 != 0 {  // adding newline if we didn't just do that
            output.append("\n")
        }
        return output
    }
}

extension UInt8 {
    var hex: String {
        switch self {
        case 0:
        return "00"
        case 1:
        return "01"
        case 2:
        return "02"
        case 3:
        return "03"
        case 4:
        return "04"
        case 5:
        return "05"
        case 6:
        return "06"
        case 7:
        return "07"
        case 8:
        return "08"
        case 9:
        return "09"
        case 10:
        return "0a"
        case 11:
        return "0b"
        case 12:
        return "0c"
        case 13:
        return "0d"
        case 14:
        return "0e"
        case 15:
        return "0f"
        case 16:
        return "10"
        case 17:
        return "11"
        case 18:
        return "12"
        case 19:
        return "13"
        case 20:
        return "14"
        case 21:
        return "15"
        case 22:
        return "16"
        case 23:
        return "17"
        case 24:
        return "18"
        case 25:
        return "19"
        case 26:
        return "1a"
        case 27:
        return "1b"
        case 28:
        return "1c"
        case 29:
        return "1d"
        case 30:
        return "1e"
        case 31:
        return "1f"
        case 32:
        return "20"
        case 33:
        return "21"
        case 34:
        return "22"
        case 35:
        return "23"
        case 36:
        return "24"
        case 37:
        return "25"
        case 38:
        return "26"
        case 39:
        return "27"
        case 40:
        return "28"
        case 41:
        return "29"
        case 42:
        return "2a"
        case 43:
        return "2b"
        case 44:
        return "2c"
        case 45:
        return "2d"
        case 46:
        return "2e"
        case 47:
        return "2f"
        case 48:
        return "30"
        case 49:
        return "31"
        case 50:
        return "32"
        case 51:
        return "33"
        case 52:
        return "34"
        case 53:
        return "35"
        case 54:
        return "36"
        case 55:
        return "37"
        case 56:
        return "38"
        case 57:
        return "39"
        case 58:
        return "3a"
        case 59:
        return "3b"
        case 60:
        return "3c"
        case 61:
        return "3d"
        case 62:
        return "3e"
        case 63:
        return "3f"
        case 64:
        return "40"
        case 65:
        return "41"
        case 66:
        return "42"
        case 67:
        return "43"
        case 68:
        return "44"
        case 69:
        return "45"
        case 70:
        return "46"
        case 71:
        return "47"
        case 72:
        return "48"
        case 73:
        return "49"
        case 74:
        return "4a"
        case 75:
        return "4b"
        case 76:
        return "4c"
        case 77:
        return "4d"
        case 78:
        return "4e"
        case 79:
        return "4f"
        case 80:
        return "50"
        case 81:
        return "51"
        case 82:
        return "52"
        case 83:
        return "53"
        case 84:
        return "54"
        case 85:
        return "55"
        case 86:
        return "56"
        case 87:
        return "57"
        case 88:
        return "58"
        case 89:
        return "59"
        case 90:
        return "5a"
        case 91:
        return "5b"
        case 92:
        return "5c"
        case 93:
        return "5d"
        case 94:
        return "5e"
        case 95:
        return "5f"
        case 96:
        return "60"
        case 97:
        return "61"
        case 98:
        return "62"
        case 99:
        return "63"
        case 100:
        return "64"
        case 101:
        return "65"
        case 102:
        return "66"
        case 103:
        return "67"
        case 104:
        return "68"
        case 105:
        return "69"
        case 106:
        return "6a"
        case 107:
        return "6b"
        case 108:
        return "6c"
        case 109:
        return "6d"
        case 110:
        return "6e"
        case 111:
        return "6f"
        case 112:
        return "70"
        case 113:
        return "71"
        case 114:
        return "72"
        case 115:
        return "73"
        case 116:
        return "74"
        case 117:
        return "75"
        case 118:
        return "76"
        case 119:
        return "77"
        case 120:
        return "78"
        case 121:
        return "79"
        case 122:
        return "7a"
        case 123:
        return "7b"
        case 124:
        return "7c"
        case 125:
        return "7d"
        case 126:
        return "7e"
        case 127:
        return "7f"
        case 128:
        return "80"
        case 129:
        return "81"
        case 130:
        return "82"
        case 131:
        return "83"
        case 132:
        return "84"
        case 133:
        return "85"
        case 134:
        return "86"
        case 135:
        return "87"
        case 136:
        return "88"
        case 137:
        return "89"
        case 138:
        return "8a"
        case 139:
        return "8b"
        case 140:
        return "8c"
        case 141:
        return "8d"
        case 142:
        return "8e"
        case 143:
        return "8f"
        case 144:
        return "90"
        case 145:
        return "91"
        case 146:
        return "92"
        case 147:
        return "93"
        case 148:
        return "94"
        case 149:
        return "95"
        case 150:
        return "96"
        case 151:
        return "97"
        case 152:
        return "98"
        case 153:
        return "99"
        case 154:
        return "9a"
        case 155:
        return "9b"
        case 156:
        return "9c"
        case 157:
        return "9d"
        case 158:
        return "9e"
        case 159:
        return "9f"
        case 160:
        return "a0"
        case 161:
        return "a1"
        case 162:
        return "a2"
        case 163:
        return "a3"
        case 164:
        return "a4"
        case 165:
        return "a5"
        case 166:
        return "a6"
        case 167:
        return "a7"
        case 168:
        return "a8"
        case 169:
        return "a9"
        case 170:
        return "aa"
        case 171:
        return "ab"
        case 172:
        return "ac"
        case 173:
        return "ad"
        case 174:
        return "ae"
        case 175:
        return "af"
        case 176:
        return "b0"
        case 177:
        return "b1"
        case 178:
        return "b2"
        case 179:
        return "b3"
        case 180:
        return "b4"
        case 181:
        return "b5"
        case 182:
        return "b6"
        case 183:
        return "b7"
        case 184:
        return "b8"
        case 185:
        return "b9"
        case 186:
        return "ba"
        case 187:
        return "bb"
        case 188:
        return "bc"
        case 189:
        return "bd"
        case 190:
        return "be"
        case 191:
        return "bf"
        case 192:
        return "c0"
        case 193:
        return "c1"
        case 194:
        return "c2"
        case 195:
        return "c3"
        case 196:
        return "c4"
        case 197:
        return "c5"
        case 198:
        return "c6"
        case 199:
        return "c7"
        case 200:
        return "c8"
        case 201:
        return "c9"
        case 202:
        return "ca"
        case 203:
        return "cb"
        case 204:
        return "cc"
        case 205:
        return "cd"
        case 206:
        return "ce"
        case 207:
        return "cf"
        case 208:
        return "d0"
        case 209:
        return "d1"
        case 210:
        return "d2"
        case 211:
        return "d3"
        case 212:
        return "d4"
        case 213:
        return "d5"
        case 214:
        return "d6"
        case 215:
        return "d7"
        case 216:
        return "d8"
        case 217:
        return "d9"
        case 218:
        return "da"
        case 219:
        return "db"
        case 220:
        return "dc"
        case 221:
        return "dd"
        case 222:
        return "de"
        case 223:
        return "df"
        case 224:
        return "e0"
        case 225:
        return "e1"
        case 226:
        return "e2"
        case 227:
        return "e3"
        case 228:
        return "e4"
        case 229:
        return "e5"
        case 230:
        return "e6"
        case 231:
        return "e7"
        case 232:
        return "e8"
        case 233:
        return "e9"
        case 234:
        return "ea"
        case 235:
        return "eb"
        case 236:
        return "ec"
        case 237:
        return "ed"
        case 238:
        return "ee"
        case 239:
        return "ef"
        case 240:
        return "f0"
        case 241:
        return "f1"
        case 242:
        return "f2"
        case 243:
        return "f3"
        case 244:
        return "f4"
        case 245:
        return "f5"
        case 246:
        return "f6"
        case 247:
        return "f7"
        case 248:
        return "f8"
        case 249:
        return "f9"
        case 250:
        return "fa"
        case 251:
        return "fb"
        case 252:
        return "fc"
        case 253:
        return "fd"
        case 254:
        return "fe"
        case 255:
        return "ff"
        default:  // should never get here
        return "00"
        }
    }
}
